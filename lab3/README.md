# Лабораторная работа 3 - Программирование ПЛИС

## Описание

Данная лабораторная работа включает в себя:
1. Анализ временных диаграмм и разработка соответствующих схем
2. Разработку продвинутого таймера на основе конечного автомата (FSM)

## Структура проекта

### Анализ сигналов (Части 1-6)
- `part_1.v` - Комбинационная схема: `q = (a | b) & (c | d)`
- `part_2.v` - Комбинационная схема: `q = b | c`
- `part_3.v` - Мультиплексор 4x1 с управлением по сигналу c
- `part_4.v` - Последовательная схема с тактовым сигналом
- `part_5.v` - Счетчик с остановкой (0-6, остановка на 4)
- `part_6.v` - XOR логика с состоянием
- `part_1_tb.v` - `part_6_tb.v` - Testbench для каждой части

### FSM Таймер (Части 1-4)
- `FSM_part_1.v` - Счетчик от 0 до 999
- `FSM_part_2.v` - 4-битный сдвиговый регистр с обратным счетом
- `FSM_part_3.v` - FSM для поиска последовательности 1101
- `FSM_part_4.v` - Продвинутый таймер (интегрированная версия)
- `FSM_part_1_tb.v` - `FSM_part_4_tb.v` - Testbench для каждой части

## Функциональность продвинутого таймера

Таймер работает по следующему алгоритму:
1. **Поиск паттерна**: Ищет последовательность `1101` во входном потоке битов
2. **Считывание задержки**: После обнаружения паттерна считывает 4 бита для определения длительности задержки
3. **Подсчет**: Отсчитывает количество тактов равное `(cnt + 1) * 1000`
4. **Уведомление**: Устанавливает сигнал `done` после завершения отсчета
5. **Сброс**: После получения подтверждения (`ack`) возвращается в начальное состояние

## Компиляция и запуск

### Требования
- Icarus Verilog (iverilog)
- GTKWave (опционально, для просмотра временных диаграмм)

### Команды

```bash
# Компилировать и запустить все тесты
make all

# Компилировать и запустить только FSM тесты
make fsm

# Компилировать и запустить только тесты анализа сигналов
make signals

# Запустить отдельные тесты анализа сигналов
make part_1_tb
make part_2_tb
make part_3_tb
make part_4_tb
make part_5_tb
make part_6_tb

# Запустить отдельные FSM тесты
make FSM_part_1_tb
make FSM_part_2_tb
make FSM_part_3_tb
make FSM_part_4_tb

# Запустить GTKWave с конкретным файлом
make gtkwave TB=part_1_tb
make gtkwave TB=FSM_part_1_tb

# Запустить GTKWave со всеми VCD файлами
make gtkwave-all

# Очистить скомпилированные файлы
make clean

# Показать справку
make help
```

## Описание модулей

### Анализ сигналов

**Part 1** (`part_1.v`): Комбинационная схема с логикой `q = (a | b) & (c | d)`

**Part 2** (`part_2.v`): Простая комбинационная схема `q = b | c`

**Part 3** (`part_3.v`): Мультиплексор 4x1, выбирает один из входов по управляющему сигналу c

**Part 4** (`part_4.v`): Последовательная схема с обновлением по тактовому сигналу

**Part 5** (`part_5.v`): Счетчик от 0 до 6 с возможностью остановки на значении 4

**Part 6** (`part_6.v`): XOR логика с внутренним состоянием

### FSM компоненты

**FSM Part 1** (`FSM_part_1.v`): Счетчик от 0 до 999 с синхронным сбросом

**FSM Part 2** (`FSM_part_2.v`): Сдвиговый регистр с обратным счетом

**FSM Part 3** (`FSM_part_3.v`): Детектор паттерна 1101 с FSM

**FSM Part 4** (`FSM_part_4.v`): Интегрированный продвинутый таймер

## Тестирование

Все модули содержат comprehensive testbench'и, которые проверяют:
- Корректность работы в нормальных условиях
- Граничные случаи
- Обработку ошибок
- Переходы между состояниями

VCD файлы генерируются в папке `out/` для просмотра в GTKWave.

## Временные диаграммы

Временные диаграммы для анализа находятся в папке `pic/`:
- `Part_1.png` - `Part_6.png` - Диаграммы для анализа сигналов
- `Part1.png` - `Part3.png` - Диаграммы для FSM частей
- `FSM_full.png` - Полная схема FSM
- `FSM_WF.png` - Временная диаграмма FSM

## Результаты тестирования

**Все модули протестированы и работают корректно:**

### Анализ сигналов (6 частей):
- ✅ Part 1: Комбинационная схема - работает правильно
- ✅ Part 2: Простая логика - работает правильно
- ✅ Part 3: Мультиплексор - работает правильно
- ✅ Part 4: Тактовая логика - работает правильно
- ✅ Part 5: Счетчик с остановкой - работает правильно
- ✅ Part 6: XOR с состоянием - работает правильно

### FSM компоненты (4 части):
- ✅ FSM Part 1: Счетчик 0-999 - работает правильно
- ✅ FSM Part 2: Сдвиговый регистр - работает правильно
- ✅ FSM Part 3: Детектор паттерна - работает правильно
- ✅ FSM Part 4: Продвинутый таймер - работает правильно

**Статус: ЛАБОРАТОРНАЯ РАБОТА ВЫПОЛНЕНА ПОЛНОСТЬЮ И ПРАВИЛЬНО**

VCD файлы генерируются для всех модулей и могут быть просмотрены в GTKWave.